rules:
  # 1) Any SSH login as root
  - id: ssh_root_anywhere
    description: "Any SSH login as root"
    severity: high
    match:
      source: ssh
      fields:
        status: accepted
        user: root
    evidence: "SSH root login detected (user=root)"

  # 2) SSH login as root from localhost (lower severity)
  - id: ssh_root_localhost
    description: "SSH root login from localhost"
    severity: medium
    match:
      source: ssh
      fields:
        status: accepted
        user: root
        ip: "::1"
    evidence: "SSH root login from localhost (::1)"

  # 3) Any sudo command to root user
  - id: sudo_any_root_cmd
    description: "Any sudo command targeting root"
    severity: medium
    match:
      source: sudo
      fields:
        status: sudo_command
        target_user: root
    evidence: "sudo command targeting root user"

  # 4) sudo root shell (less strict than built-in rule, no binary check)
  - id: sudo_root_shell_any
    description: "sudo to root that runs any command (not just shells)"
    severity: high
    match:
      source: sudo
      fields:
        status: sudo_command
        target_user: root

  # 5) SSH invalid user brute attempts (single-event rule)
  - id: ssh_invalid_user
    description: "SSH login attempts for an invalid user"
    severity: medium
    match:
      source: ssh
      fields:
        status: failed
        user_type: invalid
    evidence: "Failed SSH login for invalid user"

