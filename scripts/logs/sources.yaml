log_input:
  # auto    = prefer file if it exists, else journal
  # file    = always use the file below
  # journal = always use journalctl
  mode: journal

  # If you want to force a specific log file (e.g. custom auth.log), set it here
  # and use mode: file.
  file:

  journal:
    # [] => DO NOT filter by systemd unit.
    # We read the journal and let parsers and grep decide what to keep.
    units: []

    # 0 => no -n argument => read ALL available journal entries
    # (be careful on very old / busy systems – you can cap it if needed)
    max_lines: 0

    # Optional regex filter applied AFTER reading from journal.
    # This keeps volume sane but still doesn’t depend on units.
    grep: "(sshd|sshd-session|sudo|NetworkManager)"

    # Optional time window. Uncomment if full history is too much:
    # since: "-24h"       # examples: "-1h", "today", "2025-11-27 00:00:00"


sources:
  # -----------------------------
  # SSH via built-in SSH parser
  # -----------------------------
  ssh:
    parser: ssh
    programs:
      - sshd
      - sshd-session

  # -----------------------------
  # sudo via built-in sudo parser
  # -----------------------------
  sudo:
    parser: sudo
    programs:
      - sudo

  # -----------------------------------------------
  # NetworkManager via generic regex-based parser
  # -----------------------------------------------
  networkmanager:
    parser: generic
    programs:
      - NetworkManager
    patterns:
      # Example line: "wlp2s0: disconnected"
      - id: nm_iface_disconnected
        regex: "(?P<iface>\\S+): disconnected"
        status: disconnected
        fields:
          iface: "{iface}"

      # Example line: "wlp2s0: connected"
      - id: nm_iface_connected
        regex: "(?P<iface>\\S+): connected"
        status: connected
        fields:
          iface: "{iface}"

